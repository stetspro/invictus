<% if $allow_login %>

  <div class="mb-1rem">
    <%= devise_error_messages! %>
    <% if flash[:recaptcha_error] %>
      <div class="alert alert-danger">
        <%= flash[:recaptcha_error] %>
      </div>
    <% end %>
  </div>
  
  <div class="row">
    <div class="col-md-6 offset-md-3">
      <div class="card black-card">
        <h5 class="card-header"><%= I18n.t('devise.enlist_now') %></h5>
        <div class="card-body">
          <%= form_for(@user, url: registration_path(resource_name), validate: true) do |f| %>
          
            <h5 class="mb-3">Account</h5>
          
            <div class="field mb-3">
              <%= f.email_field :email, autocomplete: "email", placeholder: I18n.t('devise.email'), class: 'form-control' %>
            </div>
          
            <div class="field mb-3">
              <%= f.password_field :password, autocomplete: "new-password", placeholder: I18n.t('devise.password'), class: 'form-control' %>
            </div>
          
            <div class="field mb-5">
              <%= f.password_field :password_confirmation, autocomplete: "new-password", placeholder: I18n.t('devise.password_confirmation'), class: 'form-control' %>
            </div>
            
            <h5 class="mb-3">Pilot</h5>
            
            <div class="field mb-3 card black-card card-body">
              <%= f.hidden_field :avatar %>
              <div class="row">
                <div class="col-10 offset-1">
                  <div class="avatar-selector">
                    <% 17.times do |i| %>
                      <div><%= image_tag("avatars/M_#{i+1}.jpg", id: "M_#{i+1}") %></div>
                    <% end %>
                    <% 15.times do |i| %>
                      <div><%= image_tag("avatars/F_#{i+1}.jpg", id: "M_#{i+1}") %></div>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="field mb-3">
              <%= f.text_field :name, placeholder: 'Name', class: 'form-control' %>
            </div>
            
            <div class="field mb-3">
              <%= f.text_field :family_name, placeholder: I18n.t('devise.family_name'), class: 'form-control' %>
            </div>
            
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="" id="privpolCheck">
              <label class="form-check-label" for="privpolCheck">
                I have read and agree to the <%= link_to 'Privacy Policy', credits_path %>
              </label>
            </div>
            
            <div class="form-check mb-1">
              <input class="form-check-input" type="checkbox" value="" id="tosCheck">
              <label class="form-check-label" for="tosCheck">
                I have read and agree to the <%= link_to 'Terms of Services', credits_path %>
              </label>
            </div>
            
            <%= recaptcha_tags callback: 'recaptcha_callback' %>
          
            <div class="actions float-right mt-3">
              <%= button_tag( class: 'btn btn-primary btn-sm btn-load enlist-btn', disabled: true) do %>
                <span><%= I18n.t('devise.enlist_now') %></span>
                &nbsp;<i class="fas fa-arrow-right"></i>
              <% end %>
            </div>
          <% end %>
          
          <div class="mt-3">
            <%- if controller_name != 'sessions' %>
              <%= link_to "<i class='fa fa-arrow-circle-right'></i> #{I18n.t('navbar.connect')}".html_safe, new_session_path(resource_name), class: 'display-inline-block' %>
            <% end -%>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ALPHA MODAL -->
  <div class="modal fade" tabindex="-1" role="dialog" id="alphaModal">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Welcome to Stellar Invictus</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>Before you continue, please note the following:</p>
          <ul>
            <li>This game is in <span class="color-sec-high">alpha</span></li>
            <li>There may be <span class="color-sec-high">a lot of bugs</span></li>
            <li>There may be <span class="color-sec-high">complete data wipes</span></li>
            <li>There may be <span class="color-sec-high">longer downtimes</span></li>
          </ul>
          <p>If you read all this and still want to play the game, I am very happy to welcome you :)</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    $('#alphaModal').modal('show');
  </script>
  
<% else %>

  <div class="row">
    <div class="col-md-6 offset-md-3">
      <div class="card black-card card-body">
        <%= I18n.t('server.maintenance') %>
      </div>
    </div>
  </div>

<% end %>